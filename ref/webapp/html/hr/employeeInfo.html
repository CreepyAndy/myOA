<div ng-controller="employeeInfoController">
	<div class="search-result" context-menu="menuOptions">
	    <div class="form-button">
			<button type="button" ng-show="flag=='import'||flag=='saveDone'" class="btn " data-toggle="modal" data-target="#importExcelModal" data-whatever="@mdo">Import Excel</button>
			<button type="button" ng-show="flag=='importDone'"  class="btn " ng-click="saveEmployeeInfo()">Save</button>
			<button type="button" ng-show="flag=='importDone'"  class="btn "  data-toggle="modal" data-target="#importExcelModal" data-whatever="@mdo">Import Again</button>
			<button type="button" ng-show="flag=='import'||flag=='saveDone'"  class="btn" ng-click="downloadSampleExcel()">Download Sample Excel</button>
		</div>
	</div>
	
	<div class="modal fade" id="importExcelModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel">
	    <div class="modal-dialog" role="document">
	        <div class="modal-content">
	            <div class="modal-header">
	                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
	                    <span aria-hidden="true">&times;</span>
	                </button>
	                <h4 class="modal-title" id="exampleModalLabel">Import Excel</h4>
	            </div>
	            <form id="uploadForm" enctype="multipart/form-data">
	                <input type="file" name="file" class="dropify" id="importExcel" file-model="employeeInfoExcel" data-default-file="" data-max-file-size="3M" />
	            </form>
	            <div class="modal-footer">
	                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
	                <button ng-show="flag=='import'||flag=='importDone'||flag=='saveDone'" type="button" class="btn btn-warning" ng-click="importExcel()">Import</button>
	            </div>
	        </div>
	    </div>
	</div>
	<div ng-show="flag!='import'&&flag!='saveDone'">
	<div class="section personal-information" ng-show="errorNum>0">
	    <p class="title"><span>Employees with Errors</span></p>
		<table class="table">
			<thead>
				<tr>
					<th>PwC Employee ID</th>
					<th>Name</th>
					<th>EName</th>
					<th>Chinese Name</th>
					<th>Gender</th>
					<th>Hire Date</th>
					<th>Domain</th>
					<th>SDC Title Tier</th>
					<th>Coach</th>
					<th>Relationship Leader</th>
					<th>New MSO account/GUID</th>
					<th>Error Message</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="employee in errorEmployeeInfoList">
					<td>{{employee.emplNo}}</td> 
					<td>{{employee.name}}</td>
					<td>{{employee.emplName}}</td>
					<td>{{employee.chineseName}}</td>
					<td>{{employee.gender}}</td>
					<td>{{employee.gdcStartDate|date: 'M/d/yyyy'}}</td>
					<td>{{employee.supportingTeamName}}</td>
					<td>{{employee.jobTitle}}</td>
					<td>{{employee.coachName}}</td>
					<td>{{employee.leaderName}}</td>
					<td>{{employee.adName}}</td>
					<td title={{employee.msg.info}}>{{employee.msg.info| cut:true:40:' ...'}}</td>
				</tr>
			</tbody>
		</table>
	</div>
	
	<div class="section personal-information" ng-show="addNum>0">
	    <p class="title"><span>New Employees</span></p>
		<table class="table">
			<thead>
				<tr>
					<th>PwC Employee ID</th>
					<th>Name</th>
					<th>EName</th>
					<th>Chinese Name</th>
					<th>Gender</th>
					<th>Hire Date</th>
					<th>Domain</th>
					<th>SDC Title Tier</th>
					<th>Coach</th>
					<th>Relationship Leader</th>
					<th>New MSO account/GUID</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="employee in addEmployeeInfoList">
					<td>{{employee.emplNo}}</td>
					<td>{{employee.name}}</td>
					<td>{{employee.emplName}}</td>
					<td>{{employee.chineseName}}</td>
					<td>{{employee.gender}}</td>
					<td>{{employee.gdcStartDate|date: 'M/d/yyyy'}}</td>
					<td>{{employee.supportingTeamName}}</td>
					<td>{{employee.jobTitle}}</td>
					<td>{{employee.coachName}}</td>
					<td>{{employee.leaderName}}</td>
					<td>{{employee.adName}}</td>
				</tr>
			</tbody>
		</table>
	</div>
	
	<div class="section personal-information" ng-show="updateNum>0">
	    <p class="title"><span>Employees Updated</span></p>
		<table class="table">
			<thead>
				<tr>
					<th>PwC Employee ID</th>
					<th>Name</th>
					<th>EName</th>
					<th>Chinese Name</th>
					<th>Gender</th>
					<th>Hire Date</th>
					<th>Domain</th>
					<th>SDC Title Tier</th>
					<th>Coach</th>
					<th>Relationship Leader</th>
					<th>New MSO account/GUID</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="employee in updateEmployeeInfoList">
					<td>{{employee.emplNo}}</td>
					<td>{{employee.name}}</td>
					<td>{{employee.emplName}}</td>
					<td>{{employee.chineseName}}</td>
					<td>{{employee.gender}}</td>
					<td>{{employee.gdcStartDate|date: 'M/d/yyyy'}}</td>
					<td>{{employee.supportingTeamName}}</td>
					<td>{{employee.jobTitle}}</td>
					<td>{{employee.coachName}}</td>
					<td>{{employee.leaderName}}</td>
					<td>{{employee.adName}}</td>
				</tr>
			</tbody>
		</table>
	</div>
	
	<div class="section personal-information" ng-show="noChangeNum>0">
	    <p class="title"><span>Employees Not Changed</span></p>
		<table class="table">
			<thead>
				<tr>
					<th>PwC Employee ID</th>
					<th>Name</th>
					<th>EName</th>
					<th>Chinese Name</th>
					<th>Gender</th>
					<th>Hire Date</th>
					<th>Domain</th>
					<th>SDC Title Tier</th>
					<th>Coach</th>
					<th>Relationship Leader</th>
					<th>New MSO account/GUID</th>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="employee in noChangeEmployeeInfoList">
					<td>{{employee.emplNo}}</td>
					<td>{{employee.name}}</td>
					<td>{{employee.emplName}}</td>
					<td>{{employee.chineseName}}</td>
					<td>{{employee.gender}}</td>
					<td>{{employee.gdcStartDate|date: 'M/d/yyyy'}}</td>
					<td>{{employee.supportingTeamName}}</td>
					<td>{{employee.jobTitle}}</td>
					<td>{{employee.coachName}}</td>
					<td>{{employee.leaderName}}</td>
					<td>{{employee.adName}}</td>
				</tr>
			</tbody>
		</table>
	</div>
	</div>
</div>

<script type="text/javascript" src="resources/js/bootstrap-datetimepicker.min.js"></script>
<script>
$(document).ready(
    function() {
        // Basic
        $('.dropify').dropify();
        // Translated
        $('.dropify-fr').dropify({
            messages: {
                'default': 'ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œ',
                'replace': 'ç‚¹å‡»æˆ–æ‹–æ‹½æ–‡ä»¶åˆ°è¿™é‡Œæ�¥æ›¿æ�¢æ–‡ä»¶',
                'remove': 'ç§»é™¤æ–‡ä»¶',
                'error': 'å¯¹ä¸�èµ·ï¼Œä½ ä¸Šä¼ çš„æ–‡ä»¶å¤ªå¤§äº†'
            }
        });
        // Used events
        var drEvent = $('.dropify-event').dropify();
        drEvent.on('dropify.beforeClear', function(event, element) {
            return confirm("Do you really want to delete \"" + element.filename + "\" ?");
        });
        drEvent.on('dropify.afterClear', function(event, element) {
            alert('File deleted');
        });
    });
</script>